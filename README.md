# Payment Gateway 
## How to build
You need java 17 sdk installed on your machine.
And then run the following command:
```shell
./gradlew clean build
```
This will build the project and run all the tests.

## How to run
Next is to run the necessary services using docker-compose:
```shell
docker-compose up --build
```
This will start the following services:
- Payment Gateway
- MySql
- Acquiring Bank Simulator (WireMock)
- PhpMyAdmin (to be able to query the database)

## How to use

**`merchantReferenceId` needs to be generated by merchant and needs to be unique for each request.
This will prevent accidental duplicate payments, if payment gateway receives the same request twice because of infrastructure issues.**

You can send a request to the payment gateway using the following curl command:

```shell
curl -X POST 'http://localhost:8080/payment' --header 'Content-Type: application/json' -u merch001:pass1 --data '{
    "merchantReferenceId": "479",
    "creditCardNumber": "1234567890123456",
    "expiryMonth": 12,
    "expiryYear": 2023,
    "amount": 100.00,
    "currency": "USD",
    "cvv": "667",
    "status": "REQUESTED",
    "message": "Payment request created"
}'
``` 
merchantReferenceId needs to be generated by merchant and needs to be unique for each request.
This will prevent accidental duplicate payments, if payment gateway receives the same request twice because of infrastructure issues.

You can query the payment request using the following curl command:
```shell
curl -X GET 'http://localhost:8080/payment/479' -u merch001:pass1
```

## Potential Improvements and Considerations
- Add acceptance style test against the running services inside the docker
- A better packaging (folder structure). E.g. grouping commands and queries under their own folder or grouping per business feature. 
- Asynchronous communication between payment gateway and acquiring bank. This will increase resiliency and performance of the system.
- Global error handling
- Better security, this solution definitely not production ready.
- More implementation and tests around edge cases for acquiring bank simulator.
- Add logging and monitoring

## Tech Stack
- Java 17
- Docker compose for running the necessary services locally
- MySql for database
- Spring Framework for Dependency Injection, API, Security and Database layers. 
